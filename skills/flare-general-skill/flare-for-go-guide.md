# Flare for Go Developers Guide

How to interact with Flare smart contracts using Go and go-ethereum.

**Source:** [dev.flare.network/network/guides/flare-for-go-developers](https://dev.flare.network/network/guides/flare-for-go-developers)
**Examples:** https://github.com/flare-foundation/developer-hub/tree/main/examples

## Prerequisites

- Go 1.21+
- Geth and Solidity compiler (`solc`)

### Install Geth & Solidity Compiler

**macOS:**
```bash
brew tap ethereum/ethereum
brew install ethereum solidity
```

**Ubuntu:**
```bash
sudo add-apt-repository -y ppa:ethereum/ethereum
sudo apt update && sudo apt install ethereum solc
```

## Go Module Setup

```bash
go mod init your-module-name
go get github.com/ethereum/go-ethereum/ethclient
go get github.com/ethereum/go-ethereum/accounts/keystore
```

## Project Structure

```
your-project/
├── coston2/
│   └── *.go        # Coston2-specific code and generated bindings
├── flare/
│   └── *.go        # Mainnet code and bindings
├── main.go
├── go.mod
└── go.sum
```

## RPC Endpoints & Key Addresses

| Network | RPC | Chain ID |
|---------|-----|----------|
| Coston2 Testnet | `https://coston2-api.flare.network/ext/C/rpc` | 114 |
| Flare Mainnet | `https://flare-api.flare.network/ext/C/rpc` | 14 |

**FlareContractRegistry:** `0xaD67FE66660Fb8dFE9d6b1b4240d8650e30F6019` (same on all networks)

## Generating Go Bindings

Use `abigen` (included with Geth) to generate typed Go bindings from ABI files:

```bash
# Compile Solidity to get ABI
solc --evm-version cancun --abi IFlareContractRegistry.sol -o build/

# Generate Go bindings
abigen \
  --abi build/IFlareContractRegistry.abi \
  --pkg coston2 \
  --type FlareContractRegistry \
  --out coston2/FlareContractRegistry.go
```

## Examples

### Get Chain ID

```go
package main

import (
    "context"
    "fmt"

    "github.com/ethereum/go-ethereum/ethclient"
)

func main() {
    client, err := ethclient.Dial("https://coston2-api.flare.network/ext/C/rpc")
    if err != nil {
        panic(err)
    }
    defer client.Close()

    chainID, err := client.ChainID(context.Background())
    if err != nil {
        panic(err)
    }
    fmt.Println("Chain ID:", chainID) // 114
}
```

### Query a Contract

```go
package coston2

import (
    "context"
    "fmt"

    "github.com/ethereum/go-ethereum/accounts/abi/bind"
    "github.com/ethereum/go-ethereum/common"
    "github.com/ethereum/go-ethereum/ethclient"
)

func GetWNatAddress() string {
    registryAddr := common.HexToAddress("0xaD67FE66660Fb8dFE9d6b1b4240d8650e30F6019")
    client, _ := ethclient.Dial("https://coston2-api.flare.network/ext/C/rpc")
    defer client.Close()

    // FlareContractRegistry is the generated binding
    registry, _ := NewFlareContractRegistry(registryAddr, client)

    opts := &bind.CallOpts{Context: context.Background()}
    wnatAddr, _ := registry.GetContractAddressByName(opts, "WNat")

    fmt.Println("WNat address:", wnatAddr.Hex())
    return wnatAddr.Hex()
}
```

### Create a New Account

```go
package main

import (
    "crypto/ecdsa"
    "fmt"

    "github.com/ethereum/go-ethereum/crypto"
)

func main() {
    privateKey, err := crypto.GenerateKey()
    if err != nil {
        panic(err)
    }
    publicKey := privateKey.Public().(*ecdsa.PublicKey)
    address := crypto.PubkeyToAddress(*publicKey)

    fmt.Println("Address:", address.Hex())
    // Store privateKey securely — never log it in production
}
```

### Deploy a Contract

```go
package main

import (
    "context"
    "crypto/ecdsa"
    "fmt"
    "math/big"
    "os"

    "github.com/ethereum/go-ethereum/accounts/abi/bind"
    "github.com/ethereum/go-ethereum/crypto"
    "github.com/ethereum/go-ethereum/ethclient"
)

func deployContract() {
    client, _ := ethclient.Dial("https://coston2-api.flare.network/ext/C/rpc")
    defer client.Close()

    privateKey, _ := crypto.HexToECDSA(os.Getenv("PRIVATE_KEY"))
    publicKey := privateKey.Public().(*ecdsa.PublicKey)
    fromAddress := crypto.PubkeyToAddress(*publicKey)

    nonce, _ := client.PendingNonceAt(context.Background(), fromAddress)
    gasPrice, _ := client.SuggestGasPrice(context.Background())
    chainID, _ := client.ChainID(context.Background())

    auth, _ := bind.NewKeyedTransactorWithChainID(privateKey, chainID)
    auth.Nonce = big.NewInt(int64(nonce))
    auth.GasPrice = gasPrice

    // DeployMyContract is generated by abigen
    address, tx, _, _ := DeployMyContract(auth, client)
    fmt.Println("Deployed at:", address.Hex())
    fmt.Println("Tx hash:", tx.Hash().Hex())
}
```

### Read FTSO Feeds

```go
package coston2

import (
    "context"
    "fmt"

    "github.com/ethereum/go-ethereum/accounts/abi/bind"
    "github.com/ethereum/go-ethereum/common"
    "github.com/ethereum/go-ethereum/ethclient"
)

func GetFtsoFeeds() {
    client, _ := ethclient.Dial("https://coston2-api.flare.network/ext/C/rpc")
    defer client.Close()

    // First resolve FtsoV2 address via registry
    registryAddr := common.HexToAddress("0xaD67FE66660Fb8dFE9d6b1b4240d8650e30F6019")
    registry, _ := NewFlareContractRegistry(registryAddr, client)
    opts := &bind.CallOpts{Context: context.Background()}
    ftsoAddr, _ := registry.GetContractAddressByName(opts, "FtsoV2")

    // Then call FtsoV2 (TestFtsoV2Interface on testnet)
    ftso, _ := NewTestFtsoV2(ftsoAddr, client)

    feedIds := [][21]byte{
        {0x01, 0x46, 0x4c, 0x52, 0x2f, 0x55, 0x53, 0x44, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}, // FLR/USD
    }

    result, _ := ftso.GetFeedsById(opts, feedIds)
    fmt.Println("Values:", result.Values)
    fmt.Println("Decimals:", result.Decimals)
    fmt.Println("Timestamp:", result.Timestamp)
}
```

## Key Notes

- Use `abigen` to generate typed Go bindings from Solidity ABI files — avoids manual ABI encoding.
- Always compile Solidity with `--evm-version cancun`.
- Store private keys in environment variables (`PRIVATE_KEY`), never in source code.
- Use `bind.NewKeyedTransactorWithChainID` and pass the correct chain ID to avoid replay attacks.
- Get testnet C2FLR from the [Coston2 Faucet](https://faucet.flare.network/coston2).
